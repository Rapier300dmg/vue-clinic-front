(function(){"use strict";var e={5333:function(e,t,o){var r=o(5130),a=o(6768);const n={class:"content"};function s(e,t,o,r,s,i){const c=(0,a.g2)("MainNavbar"),l=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(c),(0,a.Lk)("div",n,[(0,a.bF)(l)])],64)}var i=o(4232);const c={class:"navbar"},l={key:0},d={key:1};function u(e,t,o,r,n,s){const u=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("nav",c,[(0,a.bF)(u,{to:"/",class:"nav-logo"},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)("МедСистема")]))),_:1}),(0,a.Lk)("div",{class:"menu-icon",onClick:t[0]||(t[0]=(...e)=>s.toggleMenu&&s.toggleMenu(...e))},[n.isMenuOpen?((0,a.uX)(),(0,a.CE)("span",d,"×")):((0,a.uX)(),(0,a.CE)("span",l,"☰"))]),(0,a.Lk)("div",{class:(0,i.C4)(["nav-links",{open:n.isMenuOpen}])},[(0,a.bF)(u,{to:"/"},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)("Главная")]))),_:1}),s.isAuthenticated&&"doctor"!==s.userRole?((0,a.uX)(),(0,a.Wv)(u,{key:0,to:"/appointment"},{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)(" Записаться к врачу ")]))),_:1})):(0,a.Q3)("",!0),s.isAuthenticated?((0,a.uX)(),(0,a.Wv)(u,{key:1,to:{name:"AppointmentList"}},{default:(0,a.k6)((()=>t[5]||(t[5]=[(0,a.eW)(" Ваши записи ")]))),_:1})):(0,a.Q3)("",!0),s.isAuthenticated?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(u,{key:2,to:"/login"},{default:(0,a.k6)((()=>t[6]||(t[6]=[(0,a.eW)("Войти")]))),_:1})),s.isAuthenticated?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(u,{key:3,to:"/register"},{default:(0,a.k6)((()=>t[7]||(t[7]=[(0,a.eW)("Регистрация")]))),_:1})),s.isAuthenticated?((0,a.uX)(),(0,a.Wv)(u,{key:4,to:"doctor"===s.userRole?"/doctor-profile":"/profile"},{default:(0,a.k6)((()=>t[8]||(t[8]=[(0,a.eW)(" Профиль ")]))),_:1},8,["to"])):(0,a.Q3)("",!0),s.isAuthenticated?((0,a.uX)(),(0,a.CE)("button",{key:5,onClick:t[1]||(t[1]=(...e)=>s.logout&&s.logout(...e)),class:"btn-logout"}," Выход ")):(0,a.Q3)("",!0)],2)])}o(4114);var p={name:"MainNavbar",data(){return{isMenuOpen:!1}},computed:{isAuthenticated(){return!!localStorage.getItem("token")},userRole(){return localStorage.getItem("role")}},methods:{toggleMenu(){this.isMenuOpen=!this.isMenuOpen},logout(){localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("doctorId"),this.$router.push({name:"Home"}).then((()=>window.location.reload()))}}},m=o(1241);const h=(0,m.A)(p,[["render",u],["__scopeId","data-v-f32a54f4"]]);var g=h,k={name:"App",components:{MainNavbar:g}};const v=(0,m.A)(k,[["render",s]]);var f=v,y=o(1387);const L={class:"home"},_={key:0},E={key:1},A={key:2,class:"error"},I={key:3},b={key:0,class:"patients-list"},w={key:0},C={key:1},X={key:1,class:"doctors-list"};function S(e,t,o,r,n,s){const c=(0,a.g2)("DoctorCard");return(0,a.uX)(),(0,a.CE)("div",L,[s.isDoctor?((0,a.uX)(),(0,a.CE)("h1",E,"Ваши пациенты")):((0,a.uX)(),(0,a.CE)("h1",_,"Наши врачи")),n.error?((0,a.uX)(),(0,a.CE)("div",A,(0,i.v_)(n.error),1)):((0,a.uX)(),(0,a.CE)("div",I,[s.isDoctor?((0,a.uX)(),(0,a.CE)("div",b,[n.patients.length?((0,a.uX)(),(0,a.CE)("div",w,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.patients,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e._id||e.id,class:"patient-card"},[(0,a.Lk)("p",null,[t[0]||(t[0]=(0,a.Lk)("strong",null,"Пациент:",-1)),(0,a.eW)(" "+(0,i.v_)(e.firstName)+" "+(0,i.v_)(e.lastName),1)]),(0,a.Lk)("p",null,[t[1]||(t[1]=(0,a.Lk)("strong",null,"Email:",-1)),(0,a.eW)(" "+(0,i.v_)(e.email),1)])])))),128))])):((0,a.uX)(),(0,a.CE)("p",C,"У вас пока нет записей."))])):((0,a.uX)(),(0,a.CE)("div",X,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.doctors,(e=>((0,a.uX)(),(0,a.Wv)(c,{key:e._id||e.id,doctor:e},null,8,["doctor"])))),128))]))]))])}o(8111),o(2489),o(1701),o(7642),o(8004),o(3853),o(5876),o(2475),o(5024),o(1698);var D=o(4373);const U={class:"doctor-card"};function P(e,t,o,r,n,s){return(0,a.uX)(),(0,a.CE)("div",U,[(0,a.Lk)("h2",null,(0,i.v_)(o.doctor.doctorName),1),(0,a.Lk)("p",null,(0,i.v_)(o.doctor.speciality.speciality)+" ("+(0,i.v_)(o.doctor.speciality.experience)+" лет стажа)",1)])}var N={name:"DoctorCard",props:{doctor:{type:Object,required:!0}}};const R=(0,m.A)(N,[["render",P],["__scopeId","data-v-0f9e8981"]]);var W=R;const V={NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_API_URL||"https://clinic-system-amwk.onrender.com",$=D.A.create({baseURL:V});var O={name:"HomePage",components:{DoctorCard:W},data(){return{doctors:[],patients:[],error:""}},computed:{isDoctor(){return"doctor"===localStorage.getItem("role")},doctorId(){return localStorage.getItem("doctorId")},token(){return localStorage.getItem("token")}},async created(){this.isDoctor?await this.fetchPatients():await this.fetchDoctors()},methods:{async fetchDoctors(){if(this.error="",this.token)try{$.defaults.headers.common.Authorization=`Bearer ${this.token}`;const e=await $.get("/doctor");this.doctors=Array.isArray(e.data)?e.data:[]}catch(e){console.error("Ошибка загрузки врачей:",e),this.error=e.response?.data?.message||"Не удалось загрузить список врачей."}else this.error="Пожалуйста, войдите, чтобы посмотреть список врачей."},async fetchPatients(){if(this.error="",!this.token||!this.doctorId)return void(this.error="Требуется авторизация как врач.");$.defaults.headers.common.Authorization=`Bearer ${this.token}`;let e=[];try{const t=await $.get(`/appointment/doctor/${this.doctorId}`);e=Array.isArray(t.data)?t.data:[t.data]}catch(r){if(404!==r.response?.status)return console.error("Ошибка загрузки записей:",r),void(this.error=r.response?.data?.message||"Не удалось загрузить список записей.");e=[]}if(!e.length)return void(this.patients=[]);const t=[...new Set(e.map((e=>e.patientId)).filter(Boolean))],o=[];for(const a of t)try{const e=await $.get(`/user/${a}`);o.push(e.data)}catch(r){console.warn(`Не удалось загрузить профиль пациента ${a}`,r)}this.patients=o}}};const B=(0,m.A)(O,[["render",S],["__scopeId","data-v-0b95ec1e"]]);var F=B;const q={class:"form-container"},T={key:0,class:"error"},x={class:"doctor-register"};function z(e,t,o,n,s,c){const l=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",q,[t[11]||(t[11]=(0,a.Lk)("h2",null,"Регистрация",-1)),(0,a.Lk)("form",{onSubmit:t[6]||(t[6]=(0,r.D$)(((...e)=>c.handleRegister&&c.handleRegister(...e)),["prevent"]))},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.firstName=e),type:"text",placeholder:"Имя",required:""},null,512),[[r.Jo,s.firstName]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>s.lastName=e),type:"text",placeholder:"Фамилия",required:""},null,512),[[r.Jo,s.lastName]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>s.age=e),type:"number",placeholder:"Возраст",required:""},null,512),[[r.Jo,s.age,void 0,{number:!0}]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>s.email=e),type:"email",placeholder:"Email",required:""},null,512),[[r.Jo,s.email]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>s.password=e),type:"password",placeholder:"Пароль",required:""},null,512),[[r.Jo,s.password]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>s.confirmPassword=e),type:"password",placeholder:"Подтвердите пароль",required:""},null,512),[[r.Jo,s.confirmPassword]]),t[7]||(t[7]=(0,a.Lk)("button",{type:"submit"},"Зарегистрироваться",-1)),s.error?((0,a.uX)(),(0,a.CE)("p",T,(0,i.v_)(s.error),1)):(0,a.Q3)("",!0)],32),(0,a.Lk)("div",x,[(0,a.Lk)("p",null,[t[9]||(t[9]=(0,a.eW)(" Если вы врач, зарегистрируйтесь  ")),(0,a.bF)(l,{class:"btn-doctor",to:{name:"DoctorRegister"}},{default:(0,a.k6)((()=>t[8]||(t[8]=[(0,a.eW)(" здесь ")]))),_:1}),t[10]||(t[10]=(0,a.eW)(". "))])])])}const J=D.A.create({baseURL:{NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_API_URL||"https://clinic-system-amwk.onrender.com"});var M={name:"UserRegisterPage",data(){return{firstName:"",lastName:"",age:"",email:"",password:"",confirmPassword:"",error:""}},methods:{async handleRegister(){if(this.error="",this.password===this.confirmPassword)try{await J.post("/auth/register/user",{firstName:this.firstName,lastName:this.lastName,age:Number(this.age),email:this.email,password:this.password,isManager:!1}),await this.$router.push({name:"Login"}),window.location.reload()}catch(e){console.error("Ошибка регистрации:",e),e.response?409===e.response.status?this.error="Пользователь с таким email уже зарегистрирован":this.error=e.response.data.message||"Ошибка регистрации":this.error="Не удалось подключиться к серверу"}else this.error="Пароли не совпадают"}}};const Q=(0,m.A)(M,[["render",z],["__scopeId","data-v-78f551e9"]]);var j=Q;const K={class:"form-container"},H={key:0,class:"error"};function Y(e,t,o,n,s,c){return(0,a.uX)(),(0,a.CE)("div",K,[(0,a.Lk)("h2",null,(0,i.v_)(c.isDoctorLogin?"Вход для врача":"Вход"),1),(0,a.Lk)("form",{onSubmit:t[2]||(t[2]=(0,r.D$)(((...e)=>c.handleLogin&&c.handleLogin(...e)),["prevent"]))},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.email=e),type:"email",placeholder:"Email",required:""},null,512),[[r.Jo,s.email]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>s.password=e),type:"password",placeholder:"Пароль",required:""},null,512),[[r.Jo,s.password]]),t[3]||(t[3]=(0,a.Lk)("button",{type:"submit"},"Войти",-1)),s.error?((0,a.uX)(),(0,a.CE)("p",H,(0,i.v_)(s.error),1)):(0,a.Q3)("",!0)],32)])}o(4979);var G=o(2261);const Z=(0,G.nY)("auth",{state:()=>({token:localStorage.getItem("token")||"",role:localStorage.getItem("role")||""}),getters:{isDoctor:e=>"doctor"===e.role,isManager:e=>"manager"===e.role,isPatient:e=>"patient"===e.role},actions:{setAuth(e,t){this.token=e,this.role=t,localStorage.setItem("token",e),localStorage.setItem("role",t)},clearAuth(){this.token="",this.role="",localStorage.removeItem("token"),localStorage.removeItem("role")}}}),ee=D.A.create({baseURL:{NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_API_URL||"https://clinic-system-amwk.onrender.com"});var te={name:"UserLoginPage",data(){return{email:"",password:"",error:""}},setup(){const e=Z();return{authStore:e}},computed:{isDoctorLogin(){return"doctor"===this.$route.query.role}},methods:{decodeToken(e){try{const t=e.split(".")[1],o=t.replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(o).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join(""));return JSON.parse(r)}catch{return{}}},async handleLogin(){this.error="";try{const{data:e}=await ee.post("/auth/login",{email:this.email,password:this.password}),{token:t,role:o}=e;this.authStore.setAuth(t,o),localStorage.setItem("token",t),localStorage.setItem("role",o),ee.defaults.headers.common.Authorization=`Bearer ${t}`;const r=this.decodeToken(t),a=r.userId;if(!a)throw new Error("Не удалось получить ID из токена");"doctor"===o?localStorage.setItem("doctorId",a):localStorage.setItem("userId",a),"doctor"===o?await this.$router.push({name:"DoctorProfile"}):await this.$router.push({name:"Home"}),window.location.reload()}catch(e){console.error("Ошибка логина:",e),this.error=e.response?.data?.message||e.message||"Ошибка входа"}}}};const oe=(0,m.A)(te,[["render",Y],["__scopeId","data-v-a705afac"]]);var re=oe;const ae={class:"doctor-list"},ne={class:"filter"},se=["value"],ie={key:0},ce={key:1};function le(e,t,o,n,s,c){const l=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",ae,[t[4]||(t[4]=(0,a.Lk)("h1",null,"Список врачей",-1)),(0,a.Lk)("div",ne,[t[2]||(t[2]=(0,a.Lk)("label",{for:"spec-select"},"Фильтр по специализации:",-1)),(0,a.bo)((0,a.Lk)("select",{id:"spec-select","onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedSpec=e)},[t[1]||(t[1]=(0,a.Lk)("option",{value:""},"Все",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(c.specializations,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e,value:e},(0,i.v_)(e),9,se)))),128))],512),[[r.u1,s.selectedSpec]])]),c.filteredDoctors.length?((0,a.uX)(),(0,a.CE)("ul",ie,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(c.filteredDoctors,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.id},[(0,a.Lk)("strong",null,(0,i.v_)(e.name),1),(0,a.eW)(" — "+(0,i.v_)(e.specialization)+" ",1),(0,a.bF)(l,{to:`/doctors/${e.id}`,class:"more-link"},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)(" Подробнее ")]))),_:2},1032,["to"])])))),128))])):((0,a.uX)(),(0,a.CE)("p",ce,"Нет врачей для отображения."))])}var de={name:"DoctorsListPage",data(){return{doctors:[],selectedSpec:""}},computed:{specializations(){const e=this.doctors.map((e=>e.specialization));return Array.from(new Set(e))},filteredDoctors(){return this.selectedSpec?this.doctors.filter((e=>e.specialization===this.selectedSpec)):this.doctors}},async mounted(){try{const e=localStorage.getItem("token"),t=await D.A.get("https://clinic-system-amwk.onrender.com/doctor",{headers:{Authorization:`Bearer ${e}`}});this.doctors=t.data}catch(e){console.error("Ошибка загрузки врачей:",e)}}};const ue=(0,m.A)(de,[["render",le],["__scopeId","data-v-5edcbb6e"]]);var pe=ue;const me={class:"doctor-details"},he={key:0},ge={key:1};function ke(e,t,o,r,n,s){return(0,a.uX)(),(0,a.CE)("div",me,[t[5]||(t[5]=(0,a.Lk)("h1",null,"Профиль врача",-1)),n.doctor?((0,a.uX)(),(0,a.CE)("div",he,[(0,a.Lk)("p",null,[t[0]||(t[0]=(0,a.Lk)("strong",null,"Имя:",-1)),(0,a.eW)(" "+(0,i.v_)(n.doctor.doctorName),1)]),(0,a.Lk)("p",null,[t[1]||(t[1]=(0,a.Lk)("strong",null,"Email:",-1)),(0,a.eW)(" "+(0,i.v_)(n.doctor.email),1)]),(0,a.Lk)("p",null,[t[2]||(t[2]=(0,a.Lk)("strong",null,"Специализация:",-1)),(0,a.eW)(" "+(0,i.v_)(n.doctor.speciality.speciality),1)]),(0,a.Lk)("p",null,[t[3]||(t[3]=(0,a.Lk)("strong",null,"Стаж:",-1)),(0,a.eW)(" "+(0,i.v_)(n.doctor.speciality.experience)+" лет",1)])])):((0,a.uX)(),(0,a.CE)("div",ge,t[4]||(t[4]=[(0,a.Lk)("p",null,"Загрузка профиля врача...",-1)])))])}var ve={name:"DoctorDetails",data(){return{doctor:null,error:""}},async created(){const e=this.$route.params.id,t=localStorage.getItem("token");try{const o=await D.A.get(`${{NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_API_URL}/doctor/${e}`,{headers:{Authorization:`Bearer ${t}`}});this.doctor=o.data}catch(o){console.error("Ошибка загрузки деталей врача:",o),this.error=o.response?.data?.message||"Ошибка загрузки профиля врача"}}};const fe=(0,m.A)(ve,[["render",ke],["__scopeId","data-v-2d747ef4"]]);var ye=fe;const Le={class:"form-container"},_e={class:"speciality-group"},Ee={key:0,class:"error"};function Ae(e,t,o,n,s,c){return(0,a.uX)(),(0,a.CE)("div",Le,[t[8]||(t[8]=(0,a.Lk)("h2",null,"Регистрация врача",-1)),(0,a.Lk)("form",{onSubmit:t[6]||(t[6]=(0,r.D$)(((...e)=>c.handleDoctorRegister&&c.handleDoctorRegister(...e)),["prevent"]))},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.doctorName=e),type:"text",placeholder:"Имя и фамилия",required:""},null,512),[[r.Jo,s.doctorName]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>s.email=e),type:"email",placeholder:"Email",required:""},null,512),[[r.Jo,s.email]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>s.password=e),type:"password",placeholder:"Пароль",required:""},null,512),[[r.Jo,s.password]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>s.confirmPassword=e),type:"password",placeholder:"Подтвердите пароль",required:""},null,512),[[r.Jo,s.confirmPassword]]),(0,a.Lk)("div",_e,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>s.speciality=e),type:"text",placeholder:"Специализация",required:""},null,512),[[r.Jo,s.speciality]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>s.experience=e),type:"number",placeholder:"Стаж (лет)",min:"0",required:""},null,512),[[r.Jo,s.experience,void 0,{number:!0}]])]),t[7]||(t[7]=(0,a.Lk)("button",{type:"submit"},"Зарегистрироваться",-1)),s.error?((0,a.uX)(),(0,a.CE)("p",Ee,(0,i.v_)(s.error),1)):(0,a.Q3)("",!0)],32)])}const Ie=D.A.create({baseURL:{NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_API_URL||"https://clinic-system-amwk.onrender.com"});var be={name:"DoctorRegisterPage",data(){return{doctorName:"",email:"",password:"",confirmPassword:"",speciality:"",experience:null,error:""}},methods:{async handleDoctorRegister(){if(this.error="",this.password===this.confirmPassword)try{await Ie.post("/auth/register/doctor",{doctorName:this.doctorName,email:this.email,password:this.password,speciality:{speciality:this.speciality,experience:this.experience}}),await this.$router.push({name:"Login",query:{role:"doctor"}}),window.location.reload()}catch(e){console.error("Ошибка регистрации врача:",e),e.response?409===e.response.status?this.error="Врач с таким email уже зарегистрирован":this.error=e.response.data.message||"Ошибка регистрации врача":this.error="Не удалось подключиться к серверу"}else this.error="Пароли не совпадают"}}};const we=(0,m.A)(be,[["render",Ae],["__scopeId","data-v-bf724f7e"]]);var Ce=we;const Xe={class:"doctor-profile"},Se={key:0,class:"loading"},De={key:1,class:"error"},Ue={key:2},Pe={class:"appointments"},Ne={key:0},Re={key:1},We={key:3};function Ve(e,t,o,r,n,s){return(0,a.uX)(),(0,a.CE)("div",Xe,[t[8]||(t[8]=(0,a.Lk)("h1",null,"Профиль врача",-1)),n.loading?((0,a.uX)(),(0,a.CE)("div",Se,"Загрузка...")):n.error?((0,a.uX)(),(0,a.CE)("div",De,(0,i.v_)(n.error),1)):n.doctor?((0,a.uX)(),(0,a.CE)("div",Ue,[(0,a.Lk)("p",null,[t[0]||(t[0]=(0,a.Lk)("strong",null,"Имя:",-1)),(0,a.eW)(" "+(0,i.v_)(n.doctor.doctorName),1)]),(0,a.Lk)("p",null,[t[1]||(t[1]=(0,a.Lk)("strong",null,"Email:",-1)),(0,a.eW)(" "+(0,i.v_)(n.doctor.email),1)]),(0,a.Lk)("p",null,[t[2]||(t[2]=(0,a.Lk)("strong",null,"Специализация:",-1)),(0,a.eW)(" "+(0,i.v_)(n.doctor.speciality.speciality),1)]),(0,a.Lk)("p",null,[t[3]||(t[3]=(0,a.Lk)("strong",null,"Стаж:",-1)),(0,a.eW)(" "+(0,i.v_)(n.doctor.speciality.experience)+" лет",1)]),(0,a.Lk)("div",Pe,[t[6]||(t[6]=(0,a.Lk)("h2",null,"Записи к вам",-1)),n.appointments.length?((0,a.uX)(),(0,a.CE)("ul",Ne,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.appointments,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e._id||e.id,class:"appointment-item"},[(0,a.Lk)("p",null,[t[4]||(t[4]=(0,a.Lk)("strong",null,"Пациент ID:",-1)),(0,a.eW)(" "+(0,i.v_)(e.patientId),1)]),(0,a.Lk)("p",null,[t[5]||(t[5]=(0,a.Lk)("strong",null,"Время приёма:",-1)),(0,a.eW)(" "+(0,i.v_)(s.formatDate(e.appointmentTime)),1)])])))),128))])):((0,a.uX)(),(0,a.CE)("p",Re,"У вас пока нет записей."))])])):((0,a.uX)(),(0,a.CE)("div",We,t[7]||(t[7]=[(0,a.Lk)("p",null,"Профиль не найден.",-1)])))])}o(116);const $e={NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_API_URL||"https://clinic-system-amwk.onrender.com",Oe=D.A.create({baseURL:$e});var Be={name:"DoctorProfile",data(){return{doctor:null,appointments:[],loading:!1,error:""}},async mounted(){this.loading=!0;const e=localStorage.getItem("token"),t=localStorage.getItem("doctorId");if(!e||!t)return this.error="Необходимо выполнить вход как врач.",void(this.loading=!1);Oe.defaults.headers.common.Authorization=`Bearer ${e}`;try{const{data:e}=await Oe.get("/doctor");if(this.doctor=e.find((e=>(e._id||e.id)===t)),!this.doctor)return this.error="Врач не найден",void(this.loading=!1)}catch(o){return console.error("Ошибка загрузки списка врачей:",o),this.error="Не удалось загрузить профиль врача",void(this.loading=!1)}try{const{data:e}=await Oe.get("/appointment");this.appointments=Array.isArray(e)?e.filter((e=>e.doctorId===t)):[]}catch(o){console.error("Ошибка загрузки записей:",o),this.appointments=[]}finally{this.loading=!1}},methods:{formatDate(e){return new Date(e).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}}};const Fe=(0,m.A)(Be,[["render",Ve],["__scopeId","data-v-10cd6a19"]]);var qe=Fe;const Te={class:"doctor-dashboard"};function xe(e,t,o,r,n,s){return(0,a.uX)(),(0,a.CE)("div",Te,t[0]||(t[0]=[(0,a.Lk)("h1",null,"доктор!",-1),(0,a.Lk)("p",null,"Это ваша панель управления. Здесь можно добавить функции, специфичные для докторов:",-1),(0,a.Lk)("ul",null,[(0,a.Lk)("li",null,"Просмотр списка назначений"),(0,a.Lk)("li",null,"Редактирование профиля"),(0,a.Lk)("li",null,"Просмотр статистики")],-1),(0,a.Lk)("p",null,"Обратите внимание: в этом разделе нет возможности записываться на прием, так как эта функция предназначена только для пациентов и менеджера.",-1)]))}var ze={name:"DoctorDashboard",data(){return{}},mounted(){}};const Je=(0,m.A)(ze,[["render",xe],["__scopeId","data-v-ee983c98"]]);var Me=Je;const Qe={key:0,class:"profile-container"},je={key:1,class:"error"},Ke={key:2,class:"loading"};function He(e,t,o,r,n,s){return n.user?((0,a.uX)(),(0,a.CE)("div",Qe,[t[3]||(t[3]=(0,a.Lk)("h2",null,"Профиль пользователя",-1)),(0,a.Lk)("p",null,[t[0]||(t[0]=(0,a.Lk)("strong",null,"Имя:",-1)),(0,a.eW)(" "+(0,i.v_)(n.user.firstName)+" "+(0,i.v_)(n.user.lastName),1)]),(0,a.Lk)("p",null,[t[1]||(t[1]=(0,a.Lk)("strong",null,"Email:",-1)),(0,a.eW)(" "+(0,i.v_)(n.user.email),1)]),(0,a.Lk)("p",null,[t[2]||(t[2]=(0,a.Lk)("strong",null,"Возраст:",-1)),(0,a.eW)(" "+(0,i.v_)(n.user.age),1)])])):n.error?((0,a.uX)(),(0,a.CE)("div",je,[(0,a.Lk)("p",null,(0,i.v_)(n.error),1)])):((0,a.uX)(),(0,a.CE)("div",Ke,t[4]||(t[4]=[(0,a.Lk)("p",null,"Загрузка профиля...",-1)])))}var Ye={name:"UserProfilePage",data(){return{user:null,error:""}},async created(){await this.fetchUser()},methods:{async fetchUser(){try{const e=localStorage.getItem("token");if(!e)throw new Error("Пользователь не авторизован");const t=await D.A.get(`https://clinic-system-amwk.onrender.com/user/me?nocache=${Date.now()}`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});this.user=t.data}catch(e){console.error("Ошибка при загрузке профиля:",e),this.error=e.response?.data?.message||e.message||"Ошибка загрузки профиля"}}}};const Ge=(0,m.A)(Ye,[["render",He],["__scopeId","data-v-3662ff31"]]);var Ze=Ge;const et={class:"appointment-page"},tt={key:0,class:"not-auth"},ot={key:1},rt={class:"filter"},at=["value"],nt={key:0,class:"error"},st={class:"doctors-list"},it=["onClick"],ct={key:0,class:"no-results"};function lt(e,t,o,n,s,c){const l=(0,a.g2)("router-link"),d=(0,a.g2)("DoctorCard");return(0,a.uX)(),(0,a.CE)("div",et,[t[5]||(t[5]=(0,a.Lk)("h1",null,"Запись к врачу",-1)),s.isAuthenticated?((0,a.uX)(),(0,a.CE)("div",ot,[(0,a.Lk)("div",rt,[t[4]||(t[4]=(0,a.Lk)("label",{for:"spec"},"Специализация:",-1)),(0,a.bo)((0,a.Lk)("select",{id:"spec","onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedSpec=e)},[t[3]||(t[3]=(0,a.Lk)("option",{value:""},"Все",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(c.specializations,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e,value:e},(0,i.v_)(e),9,at)))),128))],512),[[r.u1,s.selectedSpec]])]),s.error?((0,a.uX)(),(0,a.CE)("div",nt,(0,i.v_)(s.error),1)):(0,a.Q3)("",!0),(0,a.Lk)("div",st,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(c.filteredDoctors,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e._id||e.id,class:"doctor-item"},[(0,a.bF)(d,{doctor:e},null,8,["doctor"]),(0,a.Lk)("button",{class:"btn-book",onClick:t=>c.goToBooking(e)}," Записаться ",8,it)])))),128)),c.filteredDoctors.length||s.error?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("p",ct," Врачи с выбранной специализацией не найдены. "))])])):((0,a.uX)(),(0,a.CE)("div",tt,[t[2]||(t[2]=(0,a.Lk)("p",null,"Пожалуйста, войдите, чтобы записаться на приём.",-1)),(0,a.bF)(l,{to:"/login",class:"btn-login"},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("Войти")]))),_:1})]))])}var dt={name:"AppointmentPage",components:{DoctorCard:W},data(){return{isAuthenticated:!!localStorage.getItem("token"),doctors:[],selectedSpec:"",error:""}},computed:{specializations(){const e=this.doctors.map((e=>e.speciality?.speciality)).filter(Boolean);return Array.from(new Set(e)).sort()},filteredDoctors(){return this.selectedSpec?this.doctors.filter((e=>e.speciality?.speciality===this.selectedSpec)):this.doctors}},async created(){if(this.isAuthenticated)try{const e=localStorage.getItem("token"),t=await D.A.get("https://clinic-system-amwk.onrender.com/doctor",{headers:{Authorization:`Bearer ${e}`}});this.doctors=Array.isArray(t.data)?t.data:[]}catch(e){console.error("Ошибка при загрузке врачей:",e),this.error=e.response?.data?.message||"Не удалось загрузить врачей."}},methods:{goToBooking(e){const t=e._id||e.id;t?this.$router.push({name:"AppointmentBook",params:{doctorId:t}}):console.warn("Не удалось получить ID врача для записи")}}};const ut=(0,m.A)(dt,[["render",lt],["__scopeId","data-v-66f5f7ac"]]);var pt=ut;const mt={class:"appointment-book"},ht={key:0,class:"loading"},gt={key:1,class:"error"},kt={key:2},vt={class:"form-group"},ft=["disabled"];function yt(e,t,o,n,s,c){return(0,a.uX)(),(0,a.CE)("div",mt,[t[4]||(t[4]=(0,a.Lk)("h1",null,"Запись к врачу",-1)),s.loading?((0,a.uX)(),(0,a.CE)("div",ht,"Загрузка данных...")):s.message&&!s.doctor?((0,a.uX)(),(0,a.CE)("div",gt,(0,i.v_)(s.message),1)):!n.isDoctor&&s.doctor?((0,a.uX)(),(0,a.CE)("div",kt,[(0,a.Lk)("p",null,[t[2]||(t[2]=(0,a.Lk)("strong",null,"Врач:",-1)),(0,a.eW)(" "+(0,i.v_)(s.doctor.doctorName||s.doctor.name),1)]),(0,a.Lk)("div",vt,[t[3]||(t[3]=(0,a.Lk)("label",{for:"datetime"},"Дата и время приёма:",-1)),(0,a.bo)((0,a.Lk)("input",{id:"datetime",type:"datetime-local","onUpdate:modelValue":t[0]||(t[0]=e=>s.appointmentTime=e)},null,512),[[r.Jo,s.appointmentTime]])]),(0,a.Lk)("button",{class:"btn-submit",disabled:!s.appointmentTime,onClick:t[1]||(t[1]=(...e)=>c.submitAppointment&&c.submitAppointment(...e))}," Подтвердить запись ",8,ft),s.message?((0,a.uX)(),(0,a.CE)("p",{key:0,class:(0,i.C4)({success:s.success,error:!s.success})},(0,i.v_)(s.message),3)):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)])}const Lt={NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_API_URL||"https://clinic-system-amwk.onrender.com",_t=D.A.create({baseURL:Lt});var Et={name:"AppointmentButton",props:{doctorId:{type:String,required:!0}},setup(){const e=Z(),t=(0,a.EW)((()=>"doctor"===e.role));return{isDoctor:t}},data(){return{doctor:null,appointmentTime:"",message:"",success:!1,patientId:null,loading:!1}},async created(){this.loading=!0;const e=localStorage.getItem("token");if(!e)return this.message="Для записи необходимо войти.",void(this.loading=!1);_t.defaults.headers.common.Authorization=`Bearer ${e}`;try{const t=JSON.parse(atob(e.split(".")[1]));if(this.patientId=t.userId||t.id,!this.patientId)throw new Error}catch{return this.message="Не удалось определить пользователя.",void(this.loading=!1)}try{const e=await _t.get(`/doctor/${this.doctorId}`);this.doctor=e.data}catch{try{const e=(await _t.get("/doctor")).data;this.doctor=e.find((e=>(e._id||e.id)===this.doctorId)),this.doctor||(this.message="Врач не найден.")}catch{this.message="Не удалось загрузить данные врача."}}finally{this.loading=!1}},methods:{async submitAppointment(){if(this.message="",this.success=!1,!this.appointmentTime)return void(this.message="Укажите дату и время приёма");if(!this.doctor||!this.patientId)return void(this.message="Данные не загружены");const e={doctorId:this.doctorId,patientId:this.patientId,appointmentTime:new Date(this.appointmentTime).toISOString()};try{const t=await _t.post("/appointment",e),o=t.data._id||t.data.id;this.success=!0,this.message="Запись успешно создана",o&&this.$router.push({name:"AppointmentList",params:{appointmentId:o}})}catch(t){this.message=t.response?.data?.message||"Не удалось записаться"}}}};const At=(0,m.A)(Et,[["render",yt],["__scopeId","data-v-358acd62"]]);var It=At;const bt={class:"appointments-list"},wt={key:0},Ct={key:1},Xt={key:2,class:"error"},St={key:3},Dt={key:0},Ut={key:0},Pt={key:1};function Nt(e,t,o,r,n,s){return(0,a.uX)(),(0,a.CE)("div",bt,[o.appointmentId?((0,a.uX)(),(0,a.CE)("h1",Ct,"Детали записи")):((0,a.uX)(),(0,a.CE)("h1",wt,"Ваши записи")),n.error?((0,a.uX)(),(0,a.CE)("div",Xt,(0,i.v_)(n.error),1)):((0,a.uX)(),(0,a.CE)("div",St,[n.appointments.length?((0,a.uX)(),(0,a.CE)("ul",Dt,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.appointments,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e._id||e.id,class:"appointment-item"},[(0,a.Lk)("p",null,[t[0]||(t[0]=(0,a.Lk)("strong",null,"Врач:",-1)),(0,a.eW)(" "+(0,i.v_)(e.doctorId),1)]),(0,a.Lk)("p",null,[t[1]||(t[1]=(0,a.Lk)("strong",null,"Дата и время:",-1)),(0,a.eW)(" "+(0,i.v_)(s.formatDate(e.appointmentTime)),1)]),e.patientId?((0,a.uX)(),(0,a.CE)("p",Ut,[t[2]||(t[2]=(0,a.Lk)("strong",null,"ID пациента:",-1)),(0,a.eW)(" "+(0,i.v_)(e.patientId),1)])):(0,a.Q3)("",!0)])))),128))])):((0,a.uX)(),(0,a.CE)("p",Pt,"Записи не найдены."))]))])}const Rt={NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_API_URL||"https://clinic-system-amwk.onrender.com",Wt=D.A.create({baseURL:Rt});var Vt={name:"AppointmentList",props:{appointmentId:{type:String,default:null}},data(){return{appointments:[],error:""}},async created(){const e=localStorage.getItem("token");if(!e)return void(this.error="Пользователь не авторизован");Wt.defaults.headers.common.Authorization=`Bearer ${e}`;const t=localStorage.getItem("role"),o="doctor"===t?"doctorId":"userId",r=localStorage.getItem(o);if(r)try{if(this.appointmentId){const e=await Wt.get(`/appointment/${this.appointmentId}`);return void(this.appointments=[e.data])}if("doctor"===t){try{const e=await Wt.get(`/appointment/doctor/${r}`);this.appointments=Array.isArray(e.data)?e.data:[e.data]}catch(a){this.appointments=[]}return}try{const e=await Wt.get(`/appointment/patient/${r}`);this.appointments=Array.isArray(e.data)?e.data:[e.data]}catch(a){if(404!==a.response?.status&&403!==a.response?.status)throw a;this.appointments=[]}}catch(a){console.error("Ошибка загрузки записей:",a),this.error=a.response?.data?.message||"Ошибка загрузки записей"}else this.error="Не удалось определить идентификатор"},methods:{formatDate(e){return new Date(e).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}}};const $t=(0,m.A)(Vt,[["render",Nt],["__scopeId","data-v-513c3a4c"]]);var Ot=$t;const Bt={class:"not-found"};function Ft(e,t,o,r,n,s){const i=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",Bt,[t[1]||(t[1]=(0,a.Lk)("h1",null,"404 - Страница не найдена",-1)),t[2]||(t[2]=(0,a.Lk)("p",null,"Упс! Такой страницы не существует.",-1)),(0,a.bF)(i,{to:"/"},{default:(0,a.k6)((()=>t[0]||(t[0]=[(0,a.eW)("Вернуться на главную")]))),_:1})])}var qt={name:"NotFoundPage"};const Tt=(0,m.A)(qt,[["render",Ft],["__scopeId","data-v-688e76c0"]]);var xt=Tt;const zt=[{path:"/",name:"Home",component:F},{path:"/register",name:"Register",component:j},{path:"/register/doctor",name:"DoctorRegister",component:Ce},{path:"/login",name:"Login",component:re},{path:"/doctors",name:"DoctorsList",component:pe},{path:"/doctors/:id",name:"DoctorDetails",component:ye,props:!0},{path:"/doctor-profile",name:"DoctorProfile",component:qe},{path:"/doctor-dashboard",name:"DoctorDashboard",component:Me},{path:"/profile",name:"Profile",component:Ze},{path:"/appointment",name:"Appointment",component:pt},{path:"/appointment/:doctorId",name:"AppointmentBook",component:It,props:!0},{path:"/appointment-list/:appointmentId?",name:"AppointmentList",component:Ot,props:!0},{path:"/:pathMatch(.*)*",name:"NotFound",component:xt}];var Jt=(0,y.aE)({history:(0,y.LA)(),routes:zt});const Mt=(0,r.Ef)(f);Mt.use(Jt),Mt.use((0,G.Ey)()),Mt.mount("#app")}},t={};function o(r){var a=t[r];if(void 0!==a)return a.exports;var n=t[r]={exports:{}};return e[r].call(n.exports,n,n.exports,o),n.exports}o.m=e,function(){var e=[];o.O=function(t,r,a,n){if(!r){var s=1/0;for(d=0;d<e.length;d++){r=e[d][0],a=e[d][1],n=e[d][2];for(var i=!0,c=0;c<r.length;c++)(!1&n||s>=n)&&Object.keys(o.O).every((function(e){return o.O[e](r[c])}))?r.splice(c--,1):(i=!1,n<s&&(s=n));if(i){e.splice(d--,1);var l=a();void 0!==l&&(t=l)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[r,a,n]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,r){var a,n,s=r[0],i=r[1],c=r[2],l=0;if(s.some((function(t){return 0!==e[t]}))){for(a in i)o.o(i,a)&&(o.m[a]=i[a]);if(c)var d=c(o)}for(t&&t(r);l<s.length;l++)n=s[l],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(d)},r=self["webpackChunkclinic_frontend"]=self["webpackChunkclinic_frontend"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=o.O(void 0,[504],(function(){return o(5333)}));r=o.O(r)})();
//# sourceMappingURL=app.fd9ad7f9.js.map